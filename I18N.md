# Internationalization (i18n) Setup

M-Host DMARC platform supports full internationalization with Slovenian as the primary language and English as secondary.

## Configuration

### Supported Locales

- **Slovenian** (`sl`) - Primary/default language
- **English** (`en`) - Secondary language

### Framework

We use [next-intl](https://next-intl-docs.vercel.app/) for internationalization, which provides:
- Type-safe translations
- App Router support
- Server and client component compatibility
- Automatic locale detection
- Message formatting

## File Structure

```
dmarc-m-host/
â”œâ”€â”€ i18n.ts                    # i18n configuration
â”œâ”€â”€ messages/
â”‚   â”œâ”€â”€ sl.json               # Slovenian translations
â”‚   â””â”€â”€ en.json               # English translations
â”œâ”€â”€ middleware.ts             # Locale detection (future)
â””â”€â”€ app/
    â””â”€â”€ [locale]/             # Locale-based routes (future)
```

## Translation Files

### Structure

Translations are organized by feature domain:

```json
{
  "common": { ... },           // Common UI elements
  "auth": { ... },             // Authentication
  "dashboard": { ... },        // Dashboard
  "domain": { ... },           // Domain management
  "analytics": { ... },        // Analytics
  "dmarc": { ... },            // DMARC configuration
  "customers": { ... },        // Customer management
  "admin": { ... },            // Admin features
  "navigation": { ... },       // Navigation menus
  "branding": { ... },         // App branding
  "errors": { ... }            // Error messages
}
```

### Current Implementation

**messages/sl.json** - Slovenian translations (primary)
**messages/en.json** - English translations (secondary)

Both files contain complete translations for all UI strings.

## Usage in Components

### Server Components

```typescript
import { useTranslations } from 'next-intl';

export default function Page() {
  const t = useTranslations('domain');

  return (
    <div>
      <h1>{t('domains')}</h1>
      <p>{t('manageDomains')}</p>
    </div>
  );
}
```

### Client Components

```typescript
'use client';

import { useTranslations } from 'next-intl';

export default function Button() {
  const t = useTranslations('common');

  return <button>{t('save')}</button>;
}
```

### With Variables

```typescript
const t = useTranslations('analytics');

// Using variables in translations
<p>{t('lastDays', { days: 30 })}</p>

// Translation in sl.json:
// "lastDays": "Zadnjih {days} dni"
```

## Implementation Steps

### Step 1: Configure i18n (Already Done)

The `i18n.ts` file is configured:

```typescript
import { getRequestConfig } from 'next-intl/server';

export const locales = ['sl', 'en'] as const;
export type Locale = (typeof locales)[number];

export default getRequestConfig(async ({ locale }) => ({
  messages: (await import(`./messages/${locale}.json`)).default,
}));
```

### Step 2: Update next.config.js (TODO)

Add i18n plugin to Next.js config:

```javascript
const withNextIntl = require('next-intl/plugin')('./i18n.ts');

module.exports = withNextIntl({
  output: 'standalone',
  images: { unoptimized: true },
});
```

### Step 3: Create Locale-based Routing (TODO)

Restructure app directory for locale routing:

```
app/
â”œâ”€â”€ [locale]/
â”‚   â”œâ”€â”€ layout.tsx           # Root layout with locale
â”‚   â”œâ”€â”€ page.tsx             # Home page
â”‚   â”œâ”€â”€ login/
â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”œâ”€â”€ register/
â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â””â”€â”€ app/
â”‚       â”œâ”€â”€ layout.tsx
â”‚       â””â”€â”€ domains/
â”‚           â””â”€â”€ page.tsx
```

### Step 4: Update Middleware (TODO)

Add locale detection to middleware:

```typescript
import createMiddleware from 'next-intl/middleware';
import { NextRequest, NextResponse } from 'next/server';
import { getToken } from 'next-auth/jwt';

const intlMiddleware = createMiddleware({
  locales: ['sl', 'en'],
  defaultLocale: 'sl',
});

export async function middleware(request: NextRequest) {
  // Handle i18n
  const response = intlMiddleware(request);

  // Then handle auth (existing logic)
  const token = await getToken({
    req: request,
    secret: process.env.NEXTAUTH_SECRET,
  });

  // ... existing auth logic

  return response;
}
```

### Step 5: Update All Components (TODO)

Replace hardcoded strings with translation keys:

**Before:**
```typescript
<h1>Domains</h1>
<Button>Add Domain</Button>
```

**After:**
```typescript
const t = useTranslations('domain');

<h1>{t('domains')}</h1>
<Button>{t('addDomain')}</Button>
```

### Step 6: Add Language Switcher (TODO)

Create a language switcher component:

```typescript
'use client';

import { useLocale } from 'next-intl';
import { useRouter, usePathname } from 'next/navigation';

export function LanguageSwitcher() {
  const locale = useLocale();
  const router = useRouter();
  const pathname = usePathname();

  const switchLocale = (newLocale: string) => {
    const newPathname = pathname.replace(`/${locale}`, `/${newLocale}`);
    router.push(newPathname);
  };

  return (
    <div>
      <button
        onClick={() => switchLocale('sl')}
        className={locale === 'sl' ? 'active' : ''}
      >
        SlovenÅ¡Äina
      </button>
      <button
        onClick={() => switchLocale('en')}
        className={locale === 'en' ? 'active' : ''}
      >
        English
      </button>
    </div>
  );
}
```

## Translation Guidelines

### Slovenian Translations

- Use professional, formal tone ("Vi" form, not "ti")
- Technical terms: Use established Slovenian IT terminology
- Keep translations concise but clear
- Maintain consistency across similar features

### English Translations

- Use professional, enterprise tone
- Avoid colloquialisms
- Keep technical terms in English (e.g., "DMARC", "SPF", "DKIM")
- Maintain parallel structure with Slovenian

### Adding New Translations

1. Add the key to both `messages/sl.json` and `messages/en.json`
2. Use descriptive, hierarchical keys (e.g., `domain.addNewDomain`)
3. Group related translations under the same namespace
4. Use variables for dynamic content: `{variableName}`

Example:

```json
{
  "domain": {
    "successMessage": "Domena {domainName} je bila uspeÅ¡no dodana"
  }
}
```

## Date and Number Formatting

next-intl provides built-in formatting:

```typescript
import { useFormatter } from 'next-intl';

export default function Component() {
  const format = useFormatter();

  // Date formatting
  const formattedDate = format.dateTime(new Date(), {
    year: 'numeric',
    month: 'long',
    day: 'numeric'
  });

  // Number formatting
  const formattedNumber = format.number(1234567, {
    style: 'decimal'
  });

  return <div>{formattedDate} - {formattedNumber}</div>;
}
```

## Current Status

### âœ… Completed

- i18n configuration file created
- Complete Slovenian translation file (messages/sl.json)
- Complete English translation file (messages/en.json)
- Translation namespaces organized by feature

### ğŸš§ TODO

- Update next.config.js with next-intl plugin
- Restructure app directory for locale-based routing
- Update middleware for locale detection
- Replace all hardcoded strings with translation keys
- Add language switcher component
- Implement date/time formatting with locale awareness
- Add locale detection from browser preferences
- Create locale-specific PDF reports

## Testing Translations

### Manual Testing

1. Start development server: `npm run dev`
2. Navigate to different pages
3. Verify all strings are translated correctly
4. Test with both locales

### Automated Testing (Future)

Add tests to verify:
- All translation keys exist in both locale files
- No missing translations
- Variable placeholders match between locales

Example test:

```typescript
import slTranslations from '@/messages/sl.json';
import enTranslations from '@/messages/en.json';

describe('Translations', () => {
  it('should have matching keys in both locales', () => {
    const slKeys = Object.keys(slTranslations);
    const enKeys = Object.keys(enTranslations);
    expect(slKeys).toEqual(enKeys);
  });
});
```

## Translation Workflow

### Adding a New Feature

1. Write feature code with English strings first
2. Extract all strings to translation files
3. Add to `messages/en.json` with descriptive keys
4. Translate to Slovenian in `messages/sl.json`
5. Update component to use `useTranslations()`
6. Test in both locales

### Updating Existing Translations

1. Locate the translation key in both locale files
2. Update the translation value
3. Verify the change doesn't break layouts
4. Test in production environment

## Production Considerations

- Default locale is **Slovenian** (`sl`)
- All public-facing text should be translated
- Error messages should be localized
- Email notifications should use recipient's locale
- PDF reports should use customer's preferred locale
- Admin interface can be bilingual

## Resources

- [next-intl Documentation](https://next-intl-docs.vercel.app/)
- [ISO 639-1 Language Codes](https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes)
- [Slovenian Style Guide](https://www.ijs.si/ijsw/JSI)

## Support

For questions about translations or i18n implementation, contact the M-Host development team.
